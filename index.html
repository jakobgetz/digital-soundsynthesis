<!DOCTYPE html>
<html lang="en">
  <head>
    <meta
      author="Jakob Getz"
      university="Hochschule der Medien Stuttgart"
      email="jg123@hdm-stuttgart.de"
    />
    <title>Custom Wave Shapes</title>
  </head>
  <body>
    <h2>Custom Wave Shapes</h2>

    <!--Create Input Elements-->
    <!--Start AudioContext-->
    <button onclick="startAudioContext()">Start AudioContext</button>
    <br />

    <!--On/Off-->
    <button onclick="connect()">On</button>
    <button onclick="disconnect()">Off</button>
    <br />
    
    <!--Sine/Saw-->
    <button onclick="setWaveForm(createSine())">Sine</button>
    <button onclick="setWaveForm(createSawtooth())">Saw</button>

    <!--Javascript-->
    <script>
      // define variables
      let context;
      let oscillator;

      // define functions
      const startAudioContext = () => {
        context = new AudioContext();
        oscillator = context.createOscillator();
        oscillator.start();

        setWaveForm(createSawtooth());
      };
      
      const setWaveForm = (periodicWave) => {
        oscillator.setPeriodicWave(periodicWave);
      };

      const connect = () => oscillator.connect(context.destination);
      const disconnect = () => oscillator.disconnect();

      const createSine = () => {
        const real = new Float32Array(2);
        const imag = new Float32Array(2);
        imag[1] = 1;
        return context.createPeriodicWave(real, imag);
      };

      const createSawtooth = () => {
        const resolution = 1024;
        const real = new Float32Array(resolution);
        const imag = new Float32Array(resolution);

        for (let k = 1; k < resolution; k++) {
          imag[k] = 1 / k;
        }
        return context.createPeriodicWave(real, imag);
      };
    </script>
  </body>
</html>
